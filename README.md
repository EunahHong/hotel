# 호텔 예약

> Winter School 2팀 Workspace입니다.



## 시나리오

호텔 예약 시스템에서 요구하는 기능/비기능 요구사항은 다음과 같습니다. 사용자가 예약과 함께 결제를 진행하고 나면 객실 관리자가 객실을 배정하는 시스템입니다. 이 과정에 대해서 고객은 진행 상황을 확인할 수 있고, 카카오톡으로 알림을 받을 수 있습니다. 

#### 기능적 요구사항

1. 고객이 원하는 객실을 선택 하여 예약한다.
2. 고객이 결제 한다.
3. 예약이 신청 되면 예약 신청 내역이 호텔에 전달 된다.
4. 호텔이 확인 하여 예약을 확정 한다.
5. 고객이 예약 신청을 취소할 수 있다.
6. 예약이 취소 되면 호텔 예약이 취소 된다.
7. 고객이 예약 진행 상황을 중간 중간 조회 한다.
8. 예약 상태가 바뀔 때 마다 카카오톡으로 알림을 보낸다.
9. 고객이 예약 취소를 하면 예약 정보는 삭제되나, 객실 관리팀에서는 이력 관리를 위해 취소 장부를 별도 저장한다.

#### 비 기능적 요구사항

1. 트랜잭션
   - 결제가 되지 않은 예약건은 아예 호텔 예약 신청이 되지 않아야 한다. `Sync 호출`

2. 장애격리
   - 객실관리 기능이 수행 되지 않더라도 예약은 365일 24시간 받을 수 있어야 한다. `Pub/Sub`
   - 결제 시스템이 과중되면 사용자를 잠시동안 받지 않고 결제를 잠시후에 하도록 유도 한다.
     (장애처리)

3. 성능
   - 고객이 예약 확인 상태를 마이페이지에서 확인할 수 있어야 한다. `CQRS`
   - 예약 상태가 바뀔 때 마다 카톡 등으로 알림을 줄 수 있어야 한다.

## Event Storming

#### 초기 버전

![screenshot-miro com-2020 12 18-09_30_35](https://user-images.githubusercontent.com/76149887/102559719-e6f60900-4113-11eb-96c6-54829db72270.png)

#### 2020.12.21

![screenshot-miro com-2020 12 21-13_50_26](https://user-images.githubusercontent.com/76149887/102837515-453a2900-443f-11eb-8293-e7f46bc94732.png)


#### 2020.12.22

- 예약 취소 건에 대한 추가 의견으로, 예약 취소는 이력 정보만 남기고 실제 예약 정보는 삭제하는 것으로 합의
- 예약 취소 시, 예약 취소에 대한 이력만을 저장하기 때문에 이 이력의 저장에 대한 동기 호출로 결제 취소를 하지 않고, 비동기 호출로 전환.

![screenshot-miro com-2020 12 22-10_19_41](https://user-images.githubusercontent.com/76149887/102837538-51be8180-443f-11eb-9fbc-00bec667f053.png)
